<!DOCTYPE html>

<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
  <title>Reading from input files or STDIN in Ruby using ARGF.</title>
	
	<meta name="author" content="rod">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="/css/skeleton-all-min.css">
	<link rel="stylesheet" href="/css/style.css">
  
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

  
  <link rel="icon" type="image/svg+xml" href="img/braindump-mod.svg"/>
	<link rel="alternate shortcut icon" href="img/favicon.ico">
	<link rel="apple-touch-icon" sizes="57x57" href="img/braindump-57x57.png">
	<link rel="apple-touch-icon" sizes="72x72" href="img/braindump-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="img/braindump-114x114.png">
	<link rel="apple-touch-icon" sizes="144x144" href="img/braindump-144x144.png">
  <link rel="apple-touch-startup-image" sizes="320x460" href="img/startup-320x460.png">

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34329491-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>

<body>

  

  <nav id="primary">
    <div class="container">
      <div class="fourteen columns offset-by-two">
        <ul>
          
            
            
            <li class="" >
              <a class="" href="/">Home</a>
            </li>
          
            
            
            <li class="" >
              <a class="" href="/project">Projects</a>
            </li>
          
            
            
              
            
            <li class="active" >
              <a class="active" href="/snippet">Snippets</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>

  

  <div id="main">
    <div class="container">

      

      <div class="three columns align-center">
        <div style="margin-top:50px;"><a href="/"><img src="/img/braindump-64x64.png" height="64" width="64"></a></div>
        <div class="mtop"><a href="/" class="nobr nou" style="color:#555;"><b>Rodney Waldhoff</b></a></div>
        <ul class="mtop">
          <li><a class="flatbutton" href="https://github.com/rodw"><img style="vertical-align:middle; float:left;" src="/img/octocat-24x24.png" height="24" width="24"><span class="float-right">GitHub</span></a></li>
          <li><a class="flatbutton" href="http://www.linkedin.com/in/rwald"><img style="vertical-align:middle; float:left;" src="/img/linkedin-24x24.png" height="24" width="24"><span class="float-right">LinkedIn</span></a></a></li>
        </ul>
      </div>

      

      

      
        <div class="thirteen columns">
          <div id="page-header" class="half-bottom mtop">
            
            <div class="page-class remove-bottom">
              
                  <a href="/snippet">Snippets</a> are tiny notes I've collected for easy reference.
                
            </div>
          </div>
          
        </div>
      

      

      <div class="thirteen columns bulleted">
        <div class="snippet">
  <h2 class="half-bottom">Reading from input files or STDIN in Ruby using ARGF.</h2>
  <div>
    <p><code>ARGF</code> makes it easy for a Ruby script to read from STDIN, a file specified on the command-line argument or multiple files specified on the command line, all through the same interface.</p>

<p>Recall that <code>ARGV</code> array contains the arguments passed to your Ruby script on the command line.</p>

<p><code>ARGF</code> assumes that any elements that remain in <code>ARGV</code> represent files.  Methods like <code>ARGF.each</code> (accepting a block) and <code>ARGF.readlines</code> (returning an array) operate on the concatenation of all files found in <code>ARGV</code>.  If <code>ARGV</code> is empty, then <code>ARGF</code> operates on STDIN instead.</p>

<p>For example, a <code>cat</code>-like program could be implemented in Ruby as:</p>

<div class="highlight"><pre><code class="ruby"><span class="no">ARGF</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">line</span> <span class="p">}</span>
</code></pre>
</div>


<p>When working with <code>optparse</code>, use the <code>parse!</code> method to strip recognized &ldquo;flag&rdquo; parameters from <code>ARGV</code>, leaving only the files you want to operate so that <code>ARGF</code> works just like you want it to. For example:</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">&#39;optparse&#39;</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">opt_parser</span> <span class="o">=</span> <span class="no">OptionParser</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">opt</span><span class="o">|</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;Usage: </span><span class="si">#{</span><span class="vg">$0</span><span class="si">}</span><span class="s2"> [OPTIONS]&quot;</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">separator</span>  <span class="s2">&quot;&quot;</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">separator</span>  <span class="s2">&quot;OPTIONS&quot;</span>

  <span class="n">opt</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;-h&quot;</span><span class="p">,</span><span class="s2">&quot;--heading HEADING&quot;</span><span class="p">,</span><span class="s2">&quot;a heading to display.&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">heading</span><span class="o">|</span>
    <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">]</span> <span class="o">=</span> <span class="n">heading</span>
  <span class="k">end</span>

  <span class="n">opt</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span><span class="s2">&quot;be more chatty&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">options</span><span class="o">[</span><span class="ss">:verbose</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">opt_parser</span><span class="o">.</span><span class="n">parse!</span>

<span class="nb">puts</span> <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">]</span> <span class="k">unless</span> <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">].</span><span class="n">nil?</span>
<span class="no">ARGF</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">line</span> <span class="p">}</span>
</code></pre>
</div>




  </div>
  <div class="align-right">
    <small>Tags: <a href="/snippet/t/ruby.html">ruby</a>, <a href="/snippet/t/cli.html">cli</a> and <a href="/snippet/t/rudimentary.html">rudimentary</a>.</small>
  </div>    
  
</div>
<!-- <hr/> -->


      </div>

    </div>
  </div>

  

  <div id="footer">
    <div class="container">
      <div class="sixteen columns align-center">
        <p class="half-bottom">
          <span class="nobr">rw&#97;ldho<script language="javascript">(function(){var f=function(c) { document.write(String.fromCharCode(c)); }; f(0146); f(0x66); f(0100); })();</script>g&#109;ail&#46;com</span>
          &nbsp;|&nbsp;
          <span class="nobr">(&#55;03) 5&#51;5-6<script language="javascript">document.write("0"); document.write((4-3+1)+"");</script>6</span>
        </p>
        <p class="half-bottom">
          <span class="nobr"><a href="/">heyrod.com</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a class="pointer" onclick="(function(){document.getElementById('caveator').className = (document.getElementById('caveator').className == 'off') ? 'on' : 'off';})(); return false">small print</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a href="/page/colophon.html">credits</a></span>
        </p>
        <p class="half-bottom">&copy; Copyright 2012-2013 Rodney Waldhoff.</p>
        <div id="caveator" class="off">
          <p class="smallprint">
            <!-- Except for content that belongs to someone else. Then the copyright belongs to whomever it belongs to.
            The views expressed here are solely my own. They do not reflect in any way those of any institution, organization or group with which I am affiliated.
            Also, I'm not a doctor or a lawyer or really qualified to be giving any advice at all. Ipso facto caveat emptor inter alia. --> This page was generated at 12:43 AM on 03 June 2013. <!-- Tempus fugit. -->
          </p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
