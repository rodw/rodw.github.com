<!DOCTYPE html>

<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
  <title>Using js-mode's indent logic in js2-mode.</title>
	
	<meta name="author" content="rod">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="/css/skeleton-all-min.css">
	<link rel="stylesheet" href="/css/style.css">
  
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

  
  <link rel="icon" type="image/svg+xml" href="img/braindump-mod.svg"/>
	<link rel="alternate shortcut icon" href="img/favicon.ico">
	<link rel="apple-touch-icon" sizes="57x57" href="img/braindump-57x57.png">
	<link rel="apple-touch-icon" sizes="72x72" href="img/braindump-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="img/braindump-114x114.png">
	<link rel="apple-touch-icon" sizes="144x144" href="img/braindump-144x144.png">
  <link rel="apple-touch-startup-image" sizes="320x460" href="img/startup-320x460.png">

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34329491-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>

<body>

  

  <nav id="primary">
    <div class="container">
      <div class="fourteen columns offset-by-two">
        <ul>
          
            
            
            <li class="" >
              <a class="" href="/">Home</a>
            </li>
          
            
            
            <li class="" >
              <a class="" href="/project">Projects</a>
            </li>
          
            
            
              
            
            <li class="active" >
              <a class="active" href="/snippet">Snippets</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>

  

  <div id="main">
    <div class="container">

      

      <div class="three columns align-center">
        <div style="margin-top:50px;"><a href="/"><img src="/img/braindump-64x64.png" height="64" width="64"></a></div>
        <div class="mtop"><a href="/" class="nobr nou" style="color:#555;"><b>Rodney Waldhoff</b></a></div>
        <ul class="mtop">
          <li><a class="flatbutton" href="https://github.com/rodw"><img style="vertical-align:middle; float:left;" src="/img/octocat-24x24.png" height="24" width="24"><span class="float-right">GitHub</span></a></li>
          <li><a class="flatbutton" href="http://www.linkedin.com/in/rwald"><img style="vertical-align:middle; float:left;" src="/img/linkedin-24x24.png" height="24" width="24"><span class="float-right">LinkedIn</span></a></a></li>
        </ul>
      </div>

      

      

      
        <div class="thirteen columns">
          <div id="page-header" class="half-bottom mtop">
            
            <div class="page-class remove-bottom">
              
                  <a href="/snippet">Snippets</a> are tiny notes I've collected for easy reference.
                
            </div>
          </div>
          
        </div>
      

      

      <div class="thirteen columns bulleted">
        <div class="snippet">
  <h2 class="half-bottom">Using js-mode's indent logic in js2-mode.</h2>
  <div>
    <p>Steve Yegge&rsquo;s <a href="http://code.google.com/p/js2-mode/">js2-mode</a> is a sweet major mode for working with JavaScript in Emacs, but its auto-indentation logic is <a href="http://stackoverflow.com/questions/2370028/emacs-js2-mode-disable-indenting-completely">notoriously frustrating</a>.</p>

<p>Here&rsquo;s a a somewhat hack-y workaround: switch to <code>javascript-mode</code> before calling <code>indent-region</code> and then switch back.</p>

<div class="highlight"><pre><code class="cl"><span class="c1">;; use js-mode&#39;s indent logic, by pressing C-M-| (C-M-S-\)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">rlw/js-indent-region</span> <span class="p">()</span> <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span> <span class="p">(</span><span class="nv">js-mode</span><span class="p">)</span> <span class="p">(</span><span class="nv">indent-region</span> <span class="p">(</span><span class="nv">region-beginning</span><span class="p">)</span> <span class="p">(</span><span class="nv">region-end</span><span class="p">))</span> <span class="p">(</span><span class="nv">js2-mode</span><span class="p">)</span> <span class="p">)</span>
<span class="p">(</span><span class="nv">define-key</span> <span class="nv">js2-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-M-|&quot;</span><span class="p">)</span> <span class="ss">&#39;rlw/js-indent-region</span><span class="p">)</span>
</code></pre>
</div>


<p>PS: I haven&rsquo;t yet had a chance to sort these out, but there are at least four or five JavaScript modes:</p>

<ul>
<li><a href="https://github.com/mooz/js2-mode">mooz&rsquo;s fork of js2-mode</a></li>
<li><a href="https://github.com/thomblake/js3-mode">thomblake&rsquo;s js3-mode</a></li>
<li>I think the defunct <a href="http://www.nongnu.org/espresso/">espresso-mode</a> is now the built-in <code>js-mode</code>.</li>
<li>I&rsquo;m not sure where that leaves <code>javascript-mode</code>.  Also defunct I think.</li>
<li>Steve Yegge&rsquo;s <a href="http://code.google.com/p/js2-mode/">js2-mode</a></li>
</ul>


<p>The first two are supposed to address js2-mode&rsquo;s indentation problems (among other enhancements).</p>

  </div>
  <div class="align-right">
    <small>Tags: <a href="/snippet/t/emacs.html">emacs</a>.</small>
  </div>    
  
</div>
<!-- <hr/> -->


      </div>

    </div>
  </div>

  

  <div id="footer">
    <div class="container">
      <div class="sixteen columns align-center">
        <p class="half-bottom">
          <span class="nobr">rw&#97;ldho<script language="javascript">(function(){var f=function(c) { document.write(String.fromCharCode(c)); }; f(0146); f(0x66); f(0100); })();</script>g&#109;ail&#46;com</span>
          &nbsp;|&nbsp;
          <span class="nobr">(&#55;03) 5&#51;5-6<script language="javascript">document.write("0"); document.write((4-3+1)+"");</script>6</span>
        </p>
        <p class="half-bottom">
          <span class="nobr"><a href="/">heyrod.com</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a class="pointer" onclick="(function(){document.getElementById('caveator').className = (document.getElementById('caveator').className == 'off') ? 'on' : 'off';})(); return false">small print</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a href="/page/colophon.html">credits</a></span>
        </p>
        <p class="half-bottom">&copy; Copyright 2012-2013 Rodney Waldhoff.</p>
        <div id="caveator" class="off">
          <p class="smallprint">
            <!-- Except for content that belongs to someone else. Then the copyright belongs to whomever it belongs to.
            The views expressed here are solely my own. They do not reflect in any way those of any institution, organization or group with which I am affiliated.
            Also, I'm not a doctor or a lawyer or really qualified to be giving any advice at all. Ipso facto caveat emptor inter alia. --> This page was generated at 12:43 AM on 03 June 2013. <!-- Tempus fugit. -->
          </p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
