<!DOCTYPE html>

<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
  <title>12 linux snippets</title>
	
	<meta name="author" content="rod">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="/css/skeleton-all-min.css">
	<link rel="stylesheet" href="/css/style.css">
  
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

  
  <link rel="icon" type="image/svg+xml" href="img/braindump-mod.svg"/>
	<link rel="alternate shortcut icon" href="img/favicon.ico">
	<link rel="apple-touch-icon" sizes="57x57" href="img/braindump-57x57.png">
	<link rel="apple-touch-icon" sizes="72x72" href="img/braindump-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="img/braindump-114x114.png">
	<link rel="apple-touch-icon" sizes="144x144" href="img/braindump-144x144.png">
  <link rel="apple-touch-startup-image" sizes="320x460" href="img/startup-320x460.png">
</head>

<body>
    
  

  <nav id="primary">
    <div class="container">
      <div class="fourteen columns offset-by-two">
        <ul>
          
            
            
            <li class="" >
              <a class="" href="/">Home</a>
            </li>
          
            
            
            <li class="" >
              <a class="" href="/project">Projects</a>
            </li>
          
            
            
              
            
            <li class="active" >
              <a class="active" href="/snippet">Snippets</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
  
  

  <div id="main">
    <div class="container">

      

      <div class="three columns align-center">
        <div style="margin-top:50px;"><a href="/"><img src="/img/braindump-64x64.png" height="64" width="64"></a></div>
        <div class="mtop"><a href="/" class="nobr nou" style="color:#555;"><b>Rodney Waldhoff</b></a></div>
        <ul class="mtop">
          <li><a class="flatbutton" href="https://github.com/rodw"><img style="vertical-align:middle; float:left;" src="/img/octocat-24x24.png" height="24" width="24"><span class="float-right">GitHub</span></a></li>
          <li><a class="flatbutton" href="http://www.linkedin.com/in/rwald"><img style="vertical-align:middle; float:left;" src="/img/linkedin-24x24.png" height="24" width="24"><span class="float-right">LinkedIn</span></a></a></li>
        </ul>
      </div>

      

      

      
        <div class="thirteen columns">
          <div id="page-header" class="half-bottom mtop">
            
              <h1 class=" remove-bottom">12 linux snippets</h1>
            
            <div class="page-class remove-bottom">
              
                  <a href="/snippet">Snippets</a> are tiny notes I've collected for easy reference.
                
            </div>
          </div>
          
        </div>
      

      

      <div class="thirteen columns bulleted">
        
  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/find-duplicates-on-linux.html">
        <h2 class="half-bottom">Find duplicate files on Linux.</h2>
      </a>
    
    <div>
      <p>Find files that have the same size and MD5 hash (and hence are likely to be exact duplicates):</p>

<div class="highlight"><pre><code class="console"><span class="lineno">1</span> <span class="gp">$</span> find -not -empty -type f -printf <span class="s2">&quot;%s\n&quot;</span> | <span class="se">\</span>
<span class="lineno">2</span> <span class="gp">&gt;</span> sort -rn | <span class="se">\</span>
<span class="lineno">3</span> <span class="gp">&gt;</span> uniq -d | <span class="se">\</span>
<span class="lineno">4</span> <span class="gp">&gt;</span> xargs -I<span class="o">{}</span> -n1 find -type f -size <span class="o">{}</span>c -print0 | <span class="se">\</span>
<span class="lineno">5</span> <span class="gp">&gt;</span> xargs -0 md5sum | <span class="se">\</span>
<span class="lineno">6</span> <span class="gp">&gt;</span> sort | <span class="se">\</span>
<span class="lineno">7</span> <span class="gp">&gt;</span> uniq -w32 --all-repeated<span class="o">=</span>separate | <span class="se">\</span>
<span class="lineno">8</span> <span class="gp">&gt;</span> cut -d<span class="s2">&quot; &quot;</span> -f3-
</code></pre>
</div>


<p>You probably want to pipe that to a file as it runs slowly.</p>

<p>If I understand this correctly:</p>

<ol>
<li>Line 1 enumerates the real files non-empty by size.</li>
<li>Line 2 sorts the sizes (as numbers of descending size).</li>
<li>Line 3 strips out the lines (sizes) that only appear once.</li>
<li>For each remaining size, line 4 finds all the files of that size.</li>
<li>Line 5 computes the MD5 hash for all the files found in line 4, outputting the MD5 hash and file name. (This is repeated for each set of files of a given size.)</li>
<li>Line 6 sorts that list for easy comparison.</li>
<li>Line 7 compares the first 32 characters of each line (the MD5 hash) to find duplicates.</li>
<li>Line 8 spits out the file name and path part of the matching lines.</li>
</ol>


<p>Some alternative approaches can be found at <a href="http://www.commandlinefu.com/commands/view/3555/find-duplicate-files-based-on-size-first-then-md5-hash">the original source</a>.</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    <div class="align-right"><small>Credit: Found at <a href="http://www.commandlinefu.com/commands/view/3555/find-duplicate-files-based-on-size-first-then-md5-hash">commmandlinefoo.com</a></small></div>
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/shuf-usr-share-dict-words.html">
        <h2 class="half-bottom">Generate a random list of words with `shuf`</h2>
      </a>
    
    <div>
      <p><code>shuf</code> is (in my experience) a little known GNU utility that selects random lines (or bytes) from a file.</p>

<p>For instance, the command:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> shuf -n 3 /usr/share/dict/words
</code></pre>
</div>


<p>selects three words at random from the <code>words</code> dictionary.</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/re-enable-ctrl-alt-backspace.html">
        <h2 class="half-bottom">Restore Ctrl+Alt+Backspace as a way to kill X on Linux.</h2>
      </a>
    
    <div>
      <p>Modern Debian and Ubuntu distributions have this disabled by default.</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> setxkbmap -option terminate:ctrl_alt_backspace
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/how-to-backup-an-sd-card.html">
        <h2 class="half-bottom">Backup an SD card on Linux using dd</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="bash"><span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> -b <span class="s2">&quot;/dev/$1&quot;</span> <span class="o">]</span>
<span class="k">then</span>
<span class="k">  </span><span class="nv">outfile</span><span class="o">=</span><span class="s2">&quot;sdcard-backup-`date +&quot;</span>%s<span class="s2">&quot;`.dd&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;cloning /dev/$1 to $outfile&quot;</span>
  dd <span class="k">if</span><span class="o">=</span>/dev/<span class="nv">$1</span> <span class="nv">of</span><span class="o">=</span><span class="nv">$outfile</span>
  <span class="nb">echo</span> <span class="s2">&quot;tgz-ing $outfile&quot;</span>
  tar zcvf <span class="nv">$outfile</span>.tgz <span class="nv">$outfile</span>
  <span class="nb">echo</span> <span class="s2">&quot;done.&quot;</span>
<span class="k">else </span>
<span class="k">  </span><span class="nb">echo</span> <span class="s2">&quot;Usage: $0 /dev/&lt;device&gt;&quot;</span>
<span class="k">fi</span>
<span class="nb">echo</span> <span class="s2">&quot;to restore, unmount(?), then use:&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;tar Ozxf &lt;file&gt; | dd of=&lt;device&gt;&quot;</span>
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/find-large-files.html">
        <h2 class="half-bottom">Find large files on Linux.</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="console"><span class="gp">$</span> du -h * | grep <span class="s2">&quot;^[0-9.]*M&quot;</span> | sort -n
</code></pre>
</div>


<p>(This finds files at least 1 MB in size and then sorts them by size.  Change <code>M</code> to <code>G</code> for files at least 1 GB in size.)</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a> and <a href="/snippet/t/bash.html">bash</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/using-xrandr.html">
        <h2 class="half-bottom">Set monitor resolution with xrandr</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="console"><span class="gp">$</span> cvt -r -v 1920 1080
<span class="gp">#</span> 1920x1080 59.93 Hz <span class="o">(</span>CVT 2.07M9-R<span class="o">)</span> hsync: 66.59 kHz; pclk: 138.50 MHz
<span class="go">Modeline &quot;1920x1080R&quot;  138.50  1920 1968 2000 2080  1080 1083 1088 1111 +hsync -vsync</span>
<span class="gp">$</span> xrandr --newmode <span class="s2">&quot;1920x1080R&quot;</span>  138.50  1920 1968 2000 2080  1080 1083 1088 1111 +hsync -vsync
<span class="gp">$</span> xrandr --addmode VGA1 <span class="s2">&quot;1920x1080R&quot;</span>
<span class="gp">$</span> xrandr --output VGA1 --mode <span class="s2">&quot;1920x1080R&quot;</span>
</code></pre>
</div>


<p>Also handy:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> xrandr --output LVDS1 --off --output VGA1 --auto
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/strip-chars-with-sed.html">
        <h2 class="half-bottom">Strip characters from a string or file</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="console"><span class="gp">$</span> <span class="nb">echo</span> <span class="s2">&quot;A1B2C3&quot;</span> | sed <span class="s1">&#39;s/[A-Z]//g&#39;</span>
<span class="go">123</span>
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/sed.html">sed</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      
        <h2 class="half-bottom">Strip characters from a field in awk</h2>
      
    
    <div>
      <p>E.g., the following command strips alpha characters from the second (tab delimited) field.</p>

<div class="highlight"><pre><code class="awk"><span class="nx">awk</span> <span class="o">-</span><span class="nx">F</span><span class="s2">&quot;\t&quot;</span> <span class="s1">&#39;{gsub(/[A-Za-z]/,&quot;&quot;,$2); print $2 }&#39;</span>
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/awk.html">awk</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/some-awk-basics.html">
        <h2 class="half-bottom">Some `awk` basics</h2>
      </a>
    
    <div>
      <p>Extract tab delimited fields from a file:</p>

<div class="highlight"><pre><code class="awk"><span class="nx">awk</span> <span class="o">-</span><span class="nx">F</span><span class="s2">&quot;\t&quot;</span> <span class="s1">&#39;{print &quot;field one=&quot; $1 &quot;; field two=&quot; $2 }&#39;</span> <span class="nx">file</span>
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/awk.html">awk</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/skip-n-lines.html">
        <h2 class="half-bottom">Skip the first N lines in file</h2>
      </a>
    
    <div>
      <h3>using <code>tail</code></h3>

<p>To skip the first line of a file (and start piping data at the second line):</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> tail -n +2 FILENAME
</code></pre>
</div>


<p>More generally:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> tail -n +M FILENAME
</code></pre>
</div>


<p>where <strong><code>M</code></strong> is the number of the first line you want to see (i.e., the number of lines to skip plus one).</p>

<h3>using <code>sed</code></h3>

<p>To skip the first line of a file (and start piping data at the second line):</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> sed 1d FILENAME
</code></pre>
</div>


<p>More generally:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> tail A,Bd filename
</code></pre>
</div>


<p>when you want to exclude lines <strong><code>A</code></strong> through <strong><code>B</code></strong> from the output.</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/sed.html">sed</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/list-fonts.html">
        <h2 class="half-bottom">List Availble Fonts</h2>
      </a>
    
    <div>
      <p>To view a list of available fonts, use <code>fc-list</code>.</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a> and <a href="/snippet/t/rudimentary.html">rudimentary</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/always-append-bash-history.html">
        <h2 class="half-bottom">Append to ~/.bash_history "immediately"</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="console"><span class="go">PROMPT_COMMAND=&quot;history -a; $PROMPT_COMMAND&quot;</span>
</code></pre>
</div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/bash.html">bash</a> and <a href="/snippet/t/linux.html">linux</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->



      </div>

    </div>
  </div>

  

  <div id="footer">
    <div class="container">
      <div class="sixteen columns align-center">
        <p class="half-bottom">
          <span class="nobr">rw&#97;ldho<script language="javascript">(function(){var f=function(c) { document.write(String.fromCharCode(c)); }; f(0146); f(0x66); f(0100); })();</script>g&#109;ail&#46;com</span>
          &nbsp;|&nbsp;
          <span class="nobr">(&#55;03) 5&#51;5-6<script language="javascript">document.write("0"); document.write((4-3+1)+"");</script>6</span>
        </p>
        <p class="half-bottom">
          <span class="nobr"><a href="/">heyrod.com</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a class="pointer" onclick="(function(){document.getElementById('caveator').className = (document.getElementById('caveator').className == 'off') ? 'on' : 'off';})(); return false">small print</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a href="/page/colophon.html">credits</a></span>
        </p>
        <p class="half-bottom">&copy; Copyright 2012 Rodney Waldhoff.</p>
        <div id="caveator" class="off">
          <p class="smallprint">
            Except for content that belongs to someone else. Then the copyright belongs to whomever it belongs to.
            The views expressed here are solely my own. They do not reflect in any way those of any institution, organization or group with which I am affiliated. My wife probably disagrees with me too. I can't even promise that <i>I</i> agree with anything you read here.
            Also, I'm not a doctor or a lawyer or really qualified to be giving any advice at all. Ipso facto caveat emptor inter alia. This page was generated at  1:23 PM on 24 August 2012. Tempus fugit.
          </p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>

