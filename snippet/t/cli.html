<!DOCTYPE html>

<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
  <title>6 cli snippets</title>
	
	<meta name="author" content="rod">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

  
  <link rel="icon" type="image/svg+xml" href="img/braindump-mod.svg"/>
	<link rel="alternate shortcut icon" href="img/favicon.ico">
	<link rel="apple-touch-icon" sizes="57x57" href="img/braindump-57x57.png">
	<link rel="apple-touch-icon" sizes="72x72" href="img/braindump-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="img/braindump-114x114.png">
	<link rel="apple-touch-icon" sizes="144x144" href="img/braindump-144x144.png">
  <link rel="apple-touch-startup-image" sizes="320x460" href="img/startup-320x460.png">

	<link rel="stylesheet" href="/css/skeleton-all-min.css">
	<link rel="stylesheet" href="/css/style.min.css">

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34329491-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>

<body>

  

  <nav id="primary">
    <div class="container">
      <div class="fourteen columns offset-by-two">
        <ul>
          
            
            
            <li class="" >
              <a class="" href="/">Home</a>
            </li>
          
            
            
            <li class="" >
              <a class="" href="/project">Projects</a>
            </li>
          
            
            
            <li class="" >
              <a class="" href="/article/how-to-develop-a-sourcing-strategy.html">Articles</a>
            </li>
          
            
            
              
            
            <li class="active" >
              <a class="active" href="/snippet">Snippets</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>

  

  <div id="main">
    <div class="container">

      

      <div class="three columns align-center">
        <div style="margin-top:50px;"><a href="/"><img src="/img/braindump-64x64.png" height="64" width="64"></a></div>
        <div class="mtop"><a href="/" class="nobr nou" style="color:#555;"><b>Rodney Waldhoff</b></a></div>
        <ul class="mtop">
          <li><a class="flatbutton" title="github.com/rodw" href="https://github.com/rodw"><img style="vertical-align:middle; float:left;" src="/img/octocat-24x24.png" height="24" width="24"><span class="float-right">GitHub</span></a></li>
          <li><a class="flatbutton" title="Rod @ LinkedIn" href="http://www.linkedin.com/in/rwald"><img style="vertical-align:middle; float:left;" src="/img/linkedin-24x24.png" height="24" width="24"><span class="float-right">LinkedIn</span></a></a></li>
          <li><a class="flatbutton" title="Rod @ StackOverflow" href="http://stackoverflow.com/users/1225825/rod"><img style="vertical-align:middle; float:left;" src="/img/stackoverflow-24x24.png" height="24" width="24"><span class="float-right">SOflow</span></a></a></li>
          <li><a class="flatbutton" title="Rod @ Math.StackExchange" href="http://math.stackexchange.com/users/116929/rod"><img style="vertical-align:middle; float:left;" src="/img/math-stackexchange-24x24.png" height="24" width="24"><span class="float-right">Math@SE</span></a></a></li>
          <li><a class="flatbutton" title="Rod @ TeX.StackExchange" href="http://tex.stackexchange.com/users/37896/rod"><img style="vertical-align:middle; float:left;" src="/img/tex-stackexchange-24x24.png" height="24" width="24"><span class="float-right">TeX@SE</span></a></a></li>
          <li><a class="flatbutton" title="The Graphviz Cookbook" href="http://noumlaut.com/graphviz-cookbook"><img style="vertical-align:middle; float:left;" src="/img/noumlaut-24x24.png" height="24" width="24"><span class="float-right">GV Book</span></a></a></li>
          <li><a class="flatbutton" title="Resume/CV for Rodney Waldhoff (PDF)" href="/img/Waldhoff-Rodney-resume-2014-02.pdf"><img style="vertical-align:middle; float:left;" src="/img/rod-photo-grayscale-24x24.png" height="24" width="24"><span class="float-right">Resume</span></a></li>
        </ul>
      </div>

      

      

      
        <div class="thirteen columns">
          <div id="page-header" class="half-bottom mtop">
            
              <h1 class=" remove-bottom">6 cli snippets</h1>
            
            <div class="page-class remove-bottom">
              
                  <a href="/snippet">Snippets</a> are tiny notes I've collected for easy reference.
                
            </div>
          </div>
          
        </div>
      

      

      <div class="thirteen columns bulleted">
        
  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/nodejs-require-main.html">
        <h2 class="half-bottom">Check `require.main` to test if a Node.js file is run directly</h2>
      </a>
    
    <div>
      <p>In Node, when a file is run directly from the command line, <code>require.main</code> is set to its <code>module</code>. Hence <code>require.main === module</code> tells you whether or not your script was invoked directly or required by another file.</p>

<p>A JavaScript &ldquo;main&rdquo; idiom:</p>

<div class="highlight"><pre><code class="javascript"><span class="err">#</span><span class="o">!</span><span class="err">/usr/bin/env node</span>
<span class="err">#</span> <span class="nx">file</span><span class="o">:</span> <span class="nx">example</span><span class="p">.</span><span class="nx">js</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">require</span><span class="p">.</span><span class="nx">main</span> <span class="o">===</span> <span class="nx">module</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">main</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>


<p>The <code>main</code> method will run if <code>example.js</code> is invoked via <code>node example.js</code> or <code>./example.js</code> but not when required within another script (via <code>require('./example')</code>, for example).</p>

<p>A CoffeeScript &ldquo;main&rdquo; idiom (using classes, although it doesn&rsquo;t have to):</p>

<div class="highlight"><pre><code class="coffeescript"><span class="c1">#!/usr/bin/env coffee</span>
<span class="c1"># file: example.coffee</span>
<span class="k">class</span> <span class="nx">Example</span>
  <span class="nx">main</span><span class="o">:</span><span class="p">()</span><span class="nf">-&gt;</span>
    <span class="c1"># ...</span>

<span class="k">if</span> <span class="nx">require</span><span class="p">.</span><span class="nx">main</span> <span class="o">is</span> <span class="nx">module</span>
  <span class="p">(</span><span class="k">new</span> <span class="nx">Example</span><span class="p">()).</span><span class="nx">main</span><span class="p">()</span>
</code></pre></div>


<p>The <code>main</code> method will run if <code>example.coffee</code> is invoked via <code>coffee example.coffee</code> or <code>./example.coffee</code> but not when required within another script (via <code>require('./example')</code>, for example).</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/node-js.html">node.js</a>, <a href="/snippet/t/javascript.html">javascript</a>, <a href="/snippet/t/coffeescript.html">coffeescript</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    <div class="align-right"><small>Credit: Via <a href="http://nodejs.org/docs/v0.4.8/api/all.html#accessing_the_main_module">the nodejs.org docs</a>.</small></div>
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/ruby-argf-basics.html">
        <h2 class="half-bottom">Reading from input files or STDIN in Ruby using ARGF.</h2>
      </a>
    
    <div>
      <p><code>ARGF</code> makes it easy for a Ruby script to read from STDIN, a file specified on the command-line argument or multiple files specified on the command line, all through the same interface.</p>

<p>Recall that <code>ARGV</code> array contains the arguments passed to your Ruby script on the command line.</p>

<p><code>ARGF</code> assumes that any elements that remain in <code>ARGV</code> represent files.  Methods like <code>ARGF.each</code> (accepting a block) and <code>ARGF.readlines</code> (returning an array) operate on the concatenation of all files found in <code>ARGV</code>.  If <code>ARGV</code> is empty, then <code>ARGF</code> operates on STDIN instead.</p>

<p>For example, a <code>cat</code>-like program could be implemented in Ruby as:</p>

<div class="highlight"><pre><code class="ruby"><span class="no">ARGF</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">line</span> <span class="p">}</span>
</code></pre></div>


<p>When working with <code>optparse</code>, use the <code>parse!</code> method to strip recognized &ldquo;flag&rdquo; parameters from <code>ARGV</code>, leaving only the files you want to operate so that <code>ARGF</code> works just like you want it to. For example:</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">&#39;optparse&#39;</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">opt_parser</span> <span class="o">=</span> <span class="no">OptionParser</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">opt</span><span class="o">|</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;Usage: </span><span class="si">#{</span><span class="vg">$0</span><span class="si">}</span><span class="s2"> [OPTIONS]&quot;</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">separator</span>  <span class="s2">&quot;&quot;</span>
  <span class="n">opt</span><span class="o">.</span><span class="n">separator</span>  <span class="s2">&quot;OPTIONS&quot;</span>

  <span class="n">opt</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;-h&quot;</span><span class="p">,</span><span class="s2">&quot;--heading HEADING&quot;</span><span class="p">,</span><span class="s2">&quot;a heading to display.&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">heading</span><span class="o">|</span>
    <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">]</span> <span class="o">=</span> <span class="n">heading</span>
  <span class="k">end</span>

  <span class="n">opt</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span><span class="s2">&quot;be more chatty&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">options</span><span class="o">[</span><span class="ss">:verbose</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">opt_parser</span><span class="o">.</span><span class="n">parse!</span>

<span class="nb">puts</span> <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">]</span> <span class="k">unless</span> <span class="n">options</span><span class="o">[</span><span class="ss">:heading</span><span class="o">].</span><span class="n">nil?</span>
<span class="no">ARGF</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">line</span> <span class="p">}</span>
</code></pre></div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/ruby.html">ruby</a>, <a href="/snippet/t/cli.html">cli</a> and <a href="/snippet/t/rudimentary.html">rudimentary</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/strip-chars-with-sed.html">
        <h2 class="half-bottom">Strip characters from a string or file</h2>
      </a>
    
    <div>
      

<div class="highlight"><pre><code class="console"><span class="gp">$</span> <span class="nb">echo</span> <span class="s2">&quot;A1B2C3&quot;</span> <span class="p">|</span> sed <span class="s1">&#39;s/[A-Z]//g&#39;</span>
<span class="go">123</span>
</code></pre></div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/sed.html">sed</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      
        <h2 class="half-bottom">Strip characters from a field in awk</h2>
      
    
    <div>
      <p>E.g., the following command strips alpha characters from the second (tab delimited) field.</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> awk -F<span class="s2">&quot;\t&quot;</span> <span class="s1">&#39;{gsub(/[A-Za-z]/,&quot;&quot;,$2); print $2 }&#39;</span>
</code></pre></div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/awk.html">awk</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/some-awk-basics.html">
        <h2 class="half-bottom">Some `awk` basics</h2>
      </a>
    
    <div>
      <p>Extract tab delimited fields from a file:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> awk -F<span class="s2">&quot;\t&quot;</span> <span class="s1">&#39;{print &quot;field one=&quot; $1 &quot;; field two=&quot; $2 }&#39;</span> file
</code></pre></div>




    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/awk.html">awk</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->

  <div class="snippet">
    
      <a class="permalink" href="/snippet/s/skip-n-lines.html">
        <h2 class="half-bottom">Skip the first N lines in file</h2>
      </a>
    
    <div>
      <h3>using <code>tail</code></h3>

<p>To skip the first line of a file (and start piping data at the second line):</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> tail -n +2 FILENAME
</code></pre></div>


<p>More generally:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> tail -n +M FILENAME
</code></pre></div>


<p>where <strong><code>M</code></strong> is the number of the first line you want to see (i.e., the number of lines to skip plus one).</p>

<h3>using <code>sed</code></h3>

<p>To skip the first line of a file (and start piping data at the second line):</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> sed 1d FILENAME
</code></pre></div>


<p>More generally:</p>

<div class="highlight"><pre><code class="console"><span class="gp">$</span> sed A,Bd filename
</code></pre></div>


<p>when you want to exclude lines <strong><code>A</code></strong> through <strong><code>B</code></strong> from the output.</p>

    </div>
    <div class="align-right">
      <small>Tags: <a href="/snippet/t/linux.html">linux</a>, <a href="/snippet/t/text-processing.html">text-processing</a>, <a href="/snippet/t/sed.html">sed</a> and <a href="/snippet/t/cli.html">cli</a>.</small>
    </div>    
    
  </div>
  <!-- <hr/> -->



      </div>

    </div>
  </div>

  

  <div id="footer">
    <div class="container">
      <div class="sixteen columns align-center">
        <p class="half-bottom">
          <span class="nobr">rw&#97;ldho<script language="javascript">(function(){var f=function(c) { document.write(String.fromCharCode(c)); }; f(0146); f(0x66); f(0100); })();</script>g&#109;ail&#46;com</span>
          &nbsp;|&nbsp;
          <span class="nobr">(&#55;03) 593-2<script language="javascript">document.write("3"); document.write((3-2+1)+"");</script>9</span>
        </p>
        <p class="half-bottom">
          <span class="nobr"><a href="/">heyrod.com</a></span>
          &nbsp;|&nbsp;
          <span class="nobr"><a href="/page/colophon.html">credits</a></span>
        </p>
        <p class="half-bottom">&copy; Copyright 2012-2014 Rodney Waldhoff.</p>
        <div id="caveator">
          <p class="smallprint">This page was generated at  3:59 PM on 13 February 2014</p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
